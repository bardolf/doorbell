<!DOCTYPE html>
<html>

<head>
    <title>Notification Example</title>
    <script>
        const socket = new WebSocket('wss://doorbell.skybit.cz');

        socket.addEventListener('open', (event) => {
            console.log('WebSocket connection established');
        });

        // Handle WebSocket message
        socket.addEventListener('message', (event) => {
            if (event.data === 'notification') {
                const options = {
                    body: 'Doorbell',
                    icon: 'https://doorbell.skybit.cz/warning.png',
                };

                if (Notification.permission === 'granted') {
                    const notification = new Notification('Doorbell', options);
                    setTimeout(() => {
                        notification.close();
                    }, 1000);
                } else if (Notification.permission !== 'denied') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            const notification = new Notification('Doorbell', options);
                            setTimeout(() => {
                                notification.close();
                            }, 1000);
                        }
                    });
                }
            }
        });
    </script>
</head>

<body>
<h1>Doorbell Notification</h1>
<button onclick="sendNotification()">Send test notification</button>
<script>
    function sendNotification() {
        fetch('/send-notification')
            .then(response => response.text())
            .then(message => console.log(message))
            .catch(error => console.error(error));
    }
</script>
</body>

</html>